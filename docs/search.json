[{"path":"index.html","id":"home","chapter":"Home","heading":"Home","text":"","code":""},{"path":"banding.html","id":"banding","chapter":"1 Banding","heading":"1 Banding","text":"now unexplained banding phenomenon shows cases lower elevation scans Dutch radars. appears result something going dual-PRF scans, especially vicinity clutter sources sea (wind parks, ships).","code":""},{"path":"banding.html","id":"the-problem","chapter":"1 Banding","heading":"1.1 The problem","text":"Let’s load example scan calculate RBC PPI shows issue clearly.pvol create \\((r, )\\) range-azimuth plot 7 lowest scans, issue visible higher elevations scan. Though may still occur , due elevations highest scans clear effect PPIs anyways.suggests ’s related dual-PRF scans indeed, common scans Dutch radar, just throw serve important purpose: unambiguous velocities dual-PRF scans highest, VRAD values least likely fold/alias. following scans use dual-PRFs.words, 3 elevations use, two \\(0.3^\\circ\\) scans bird-bath scan \\(90^\\circ\\), ’s option, waste, throw dual-PRF scans .","code":"\npvolfile <- \"data/20201002/NLDHL_pvol_20201002T0550_6234.h5\"\npvol <- read_pvolfile(file = pvolfile, param = \"all\")\nvp <- calculate_vp(pvolfile, verbose = FALSE)\nppi_banding <- integrate_to_ppi(pvol, vp, xlim = c(-180000, 180000), ylim = c(-180000, 180000), res = 500, param = \"DBZH\")\nplot_banding <- plot(ppi_banding) + ggtitle(\"Original RBC PPI\")\nplot_banding\nelevs <- get_elevation_angles(pvol)\nnr_elevs <- 1:7\nlapply(nr_elevs, function(x) {\n  plot(pvol$scans[[x]], xlim = c(0, 320000)) + \n    ggtitle(paste0(\"Elevation: \", round(elevs[x], 2),\n                   \"; High prf: \", pvol$scans[[x]]$attributes$how$highprf,\n                   \"; Low prf: \", pvol$scans[[x]]$attributes$how$lowprf))\n})\nget_elevation_angles(pvol)[which(sapply(pvol$scans, function(x) x$attributes$how$highprf != 0 & x$attributes$how$lowprf != 0))]##  [1]  0.3  0.8  1.2  2.0  2.8  4.5  6.0  8.0 10.0 12.0 15.0 20.0 25.0"},{"path":"banding.html","id":"solution","chapter":"1 Banding","heading":"1.2 Solution","text":"can plot parameters single elevation scan see possibilities filter banding issue .seems RHOHV DPR sufficient filter majority areas banding pattern occurs. fact, standard rain filter de-speckling (using RHOHV > 0.95 DPR < -12) probably unintentionally done . can apply filter plot results .Now recalculate RBC (right) compare results initial version banding (left).’s much better already.Finally, example moment Herwijnen radar shows substantial banding (left), moment filtered quite bit (right). load following pvol: NLHRW_pvol_20201002T1350_6356.h5.Obviously rain-filtering needs work, particular smoothing despeckling, approaches improve precipitation filtering presumably automatically improve filtering banding issue well.","code":"\npvol <- calculate_param(pvol, \n                        ZDRL = 10 ** ((DBZH - DBZV) /10),\n                        DPR = 10 * log10((ZDRL + 1 - 2 * ZDRL^0.5 * RHOHV) / (ZDRL + 1 + 2 * ZDRL^ 0.5 * RHOHV)))\nlapply(c(\"DBZH\", \"VRADH\", \"RHOHV\", \"DPR\"), function(x) plot(pvol$scans[[1]], xlim = c(0, 200000), param = x))\npvol <- calculate_param(pvol, RAIN = RHOHV >= 0.95, DBZHF = DBZH)\n\npvol$scans <- lapply(pvol$scans, function(x) {\n  dbzh <- x$params[[\"DBZH\"]]\n  rhohv <- x$params[[\"RHOHV\"]]\n  dpr <- x$params[[\"DPR\"]]\n  dbzh[rhohv >= 0.95] <- NA\n  dbzh[dpr < -12] <- NA\n  x$params[[\"DBZHF\"]] <- dbzh\n  return(x)\n})\n\nlapply(nr_elevs, function(x) {\n  plot(pvol$scans[[x]], xlim = c(0, 320000), param = \"DBZHF\") + \n    ggtitle(paste0(\"Elevation: \", round(elevs[x], 2),\n                   \"; High prf: \", pvol$scans[[x]]$attributes$how$highprf,\n                   \"; Low prf: \", pvol$scans[[x]]$attributes$how$lowprf))\n})\npvol_filtered <- calculate_param(pvol, DBZH = DBZHF)\nppi_nobanding <- integrate_to_ppi(pvol_filtered, vp, xlim = c(-180000, 180000), ylim = c(-180000, 180000), res = 500)\nplot_nobanding <- plot(ppi_nobanding) + ggtitle(\"Filtered RBC PPI\")\nplot_banding + plot_nobanding + plot_layout(guides = \"collect\")"}]
